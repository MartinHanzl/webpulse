version: 1
applications:
  - appRoot: admin
    frontend:
      phases:
        preBuild:
          commands:
            - npm install
        build:
          commands:
            - npm run generate
      artifacts:
        baseDirectory: .output/public  # Correct Nuxt 3 output directory
        files:
          - '**/*'
      cache:
        paths:
          - node_modules/**/*
    environment:
      NUXT_PUBLIC_API_BASE: "https://api.martinhanzl.cz"
    name: admin
    domain: admin.martinhanzl.cz

  - appRoot: client
    frontend:
      phases:
        preBuild:
          commands:
            - npm install
        build:
          commands:
            - npm run generate
      artifacts:
        baseDirectory: .output/public  # Correct output directory for Nuxt 3
        files:
          - '**/*'
      cache:
        paths:
          - node_modules/**/*
    environment:
      NUXT_PUBLIC_API_BASE: "https://api.martinhanzl.cz"
    name: client
    domain: martinhanzl.cz
